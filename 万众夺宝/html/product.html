<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>商品详细</title>
		<link rel="stylesheet" href="../css/mui.min.css" />
		<link rel="stylesheet" href="../css/iconfont.css" />
		<link rel="stylesheet" href="../css/common.css" />
	</head>
	<body>
		<div id="divRefreshContainer" class="mui-content mui-scroll-wrapper">
			<div class="mui-scroll">
				<!--数据列表-->
				<ul class="mui-table-view product-view mui-table-view-chevron">
				</ul>
			</div>
		</div>
	</body>
	
	<script src="../js/mui.min.js"></script>
    <script src="../js/jquery.min.js"></script>
    <script src="../js/app.js"></script>
	<script>
	mui.init({
		pullRefresh : {
			container : '#divRefreshContainer',
			down      : {
				//contentdown    : '下拉可以刷新',
				//contentover    : '释放立即刷新',
				//contentrefresh : '正在刷新...',
				callback       : funcPullDownRefresh
			},
			up        : {
				contentrefresh : '正在加载...',
				callback       : funcPullUpRefresh
			}
		}
	});
	mui("body").on("tap", ".link-product", function(event) {
		event.stopPropagation();
		var self = plus.webview.currentWebview();
		app.open('product.detail.html', {'uid':$(this).attr('data-uid'), 'title':'商品详细', 'back':'所有商品'});
	});
	function funcCreateItem (data) {
		var html = '<li class="mui-table-view-cell mui-media">              '+
				   '    <a href="javascript:;" class="mui-row link-product">'+
				   '        <img class="mui-media-object  mui-col-xs-3" />  '+
				   '        <div class="mui-media-body mui-col-xs-9"></div> '+
				   '    </a>                                                '+
				   '</li>                                                   '
		;
		var dom = $(html);
		
		$(dom).find('.link-product').attr('data-uid', data.idx);
		$(dom).find('img').attr('src', '../image/1001.png');
		$(dom).find('.mui-media-body').text(new Date().getTime() + ' - ' + data.idx);
		
		return dom;
	}
	function funcPullDownRefresh () {
		var table = $('.mui-table-view');
		var max = Math.ceil(Math.random() * 10 + 1);
		for (var i = 0; i < max; i++) {	
			$(table).prepend(funcCreateItem({idx:i}));
		}
		mui('#divRefreshContainer').pullRefresh().endPulldownToRefresh();
	}
	function funcPullUpRefresh () {
		var table = $('.mui-table-view');
		var max = Math.ceil(Math.random() * 10 + 1);
		for (var i = 0; i < max; i++) {	
			$(table).append(funcCreateItem({idx:i}));
		}
		mui('#divRefreshContainer').pullRefresh().endPullupToRefresh();
	}
	if (mui.os.plus) {
		mui.plusReady(function() {
			mui('#divRefreshContainer').pullRefresh().pulldownLoading();
		});
	} else {
		mui.ready(function() {
			mui('#divRefreshContainer').pullRefresh().pulldownLoading();
		});
	}
	</script>
</html>

